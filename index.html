<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Valentine?</title>
  <style>
    :root{
      --bg1:#0b1020;
      --bg2:#2a0b2e;
      --card:#0f162fdd;
      --text:#f7f2ff;
      --muted:#c9b7ff;
      --pink:#ff4fd8;
      --rose:#ff3b6b;
      --glow: 0 0 20px rgba(255,79,216,.45), 0 0 40px rgba(255,59,107,.25);
      --radius: 22px;
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; margin: 0; font-family: ui-rounded, system-ui, -apple-system, Segoe UI, Roboto, Arial; color: var(--text); user-select: none; -webkit-user-select: none; }

    /* Background */
    body{
      overflow: hidden;
      background: radial-gradient(1200px 900px at 20% 10%, #2b1454 0%, transparent 55%),
                  radial-gradient(900px 700px at 80% 30%, #4a1030 0%, transparent 60%),
                  radial-gradient(900px 900px at 40% 90%, #0f244d 0%, transparent 55%),
                  linear-gradient(160deg, var(--bg1), var(--bg2));
    }

    /* subtle animated glow */
    .aurora{
      position: fixed; inset: -20%;
      background: radial-gradient(closest-side, rgba(255,79,216,.22), transparent 70%),
                  radial-gradient(closest-side, rgba(120,200,255,.18), transparent 70%),
                  radial-gradient(closest-side, rgba(255,59,107,.20), transparent 70%);
      filter: blur(30px);
      animation: drift 10s ease-in-out infinite alternate;
      pointer-events: none;
      opacity: .9;
    }
    @keyframes drift {
      0%   { transform: translate(-2%, -1%) scale(1.02); }
      100% { transform: translate(2%, 1.5%) scale(1.06); }
    }

    /* Floating hearts layer */
    .hearts-layer{
      position: fixed; inset: 0;
      pointer-events: none;
      overflow: hidden;
    }
    .heart{
      position: absolute;
      bottom: -40px;
      font-size: 18px;
      opacity: 0;
      filter: drop-shadow(0 0 10px rgba(255,79,216,.45));
      animation: floatUp linear forwards;
      will-change: transform, opacity;
    }
    @keyframes floatUp{
      /* Smooth sine wave pattern for natural floating motion */
      0%   { transform: translate3d(0, 0, 0) scale(.85) rotate(0deg); opacity: 0; }
      10%  { opacity: .75; }
      12.5% { transform: translate3d(calc(var(--wave) * 0.38), calc(-0.125 * var(--dy)), 0) scale(.88) rotate(1deg); }
      25%  { transform: translate3d(calc(var(--wave) * 0.71), calc(-0.25 * var(--dy)), 0) scale(.92) rotate(2deg); }
      37.5% { transform: translate3d(calc(var(--wave) * 0.92), calc(-0.375 * var(--dy)), 0) scale(.97) rotate(2.5deg); }
      50%  { transform: translate3d(calc(var(--wave) * 1.0), calc(-0.5 * var(--dy)), 0) scale(1.02) rotate(3deg); opacity: .85; }
      62.5% { transform: translate3d(calc(var(--wave) * 0.92), calc(-0.625 * var(--dy)), 0) scale(1.07) rotate(2.5deg); }
      75%  { transform: translate3d(calc(var(--wave) * 0.71), calc(-0.75 * var(--dy)), 0) scale(1.12) rotate(2deg); }
      87.5% { transform: translate3d(calc(var(--wave) * 0.38), calc(-0.875 * var(--dy)), 0) scale(1.18) rotate(1deg); }
      100% { transform: translate3d(0, calc(-1 * var(--dy)), 0) scale(1.25) rotate(0deg); opacity: 0; }
    }

    /* Center card */
    .wrap{
      position: relative;
      height: 100%;
      display: grid;
      place-items: center;
      padding: 18px;
    }

    .card{
      width: min(520px, 92vw);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      border: 1px solid rgba(255,255,255,.12);
      border-radius: var(--radius);
      box-shadow: 0 20px 70px rgba(0,0,0,.45);
      backdrop-filter: blur(10px);
      overflow: visible;
      position: relative;
    }

    .card::before{
      content:"";
      position:absolute; inset:-2px;
      background: radial-gradient(600px 280px at 30% 0%, rgba(255,79,216,.22), transparent 60%),
                  radial-gradient(600px 280px at 70% 100%, rgba(120,200,255,.14), transparent 60%);
      pointer-events:none;
    }

    .content{
      position: relative;
      padding: 22px 22px 18px;
      text-align: center;
    }

    h1{
      margin: 8px 0 6px;
      font-weight: 800;
      letter-spacing: .2px;
      font-size: clamp(28px, 4.5vw, 40px);
      text-shadow: 0 0 18px rgba(255,79,216,.18);
    }

    .subtitle{
      margin: 0 0 16px;
      color: var(--muted);
      font-size: 14px;
    }

    .hero{
      display: grid;
      place-items: center;
      margin: 10px auto 18px;
      width: 100%;
    }

    /* Replace with your own image if you want */
    .heroBox{
      width: min(260px, 72vw);
      aspect-ratio: 1/1;
      border-radius: 18px;
      background: radial-gradient(circle at 30% 25%, rgba(255,79,216,.18), transparent 55%),
                  radial-gradient(circle at 70% 70%, rgba(120,200,255,.12), transparent 55%),
                  rgba(0,0,0,.25);
      border: 1px solid rgba(255,255,255,.10);
      box-shadow: var(--glow);
      display: grid;
      place-items: center;
      overflow: hidden;
      position: relative;
    }

    .emoji{
      font-size: 84px;
      transform: translateY(4px);
      filter: drop-shadow(0 12px 18px rgba(0,0,0,.35));
    }

    .caption{
      margin-top: 10px;
      font-weight: 700;
      letter-spacing: .2px;
      color: rgba(255,255,255,.92);
    }

    /* Buttons zone */
    .btnRow{
      position: relative;
      height: 90px;
      display: grid;
      place-items: center;
      margin-top: 10px;
      user-select: none;
      touch-action: manipulation;
    }

    .btns{
      position: relative;
      width: min(420px, 86vw);
      height: 70px;
      display: grid;
      place-items: center;
    }

    button{
      border: 0;
      border-radius: 999px;
      padding: 12px 18px;
      font-weight: 800;
      letter-spacing: .2px;
      cursor: pointer;
      transition: transform .15s ease, filter .15s ease, opacity .2s ease;
      -webkit-tap-highlight-color: transparent;
    }

    .yes{
      background: linear-gradient(135deg, rgba(255,79,216,.95), rgba(255,59,107,.95));
      color: #140013;
      box-shadow: 0 12px 28px rgba(255,79,216,.25), 0 6px 18px rgba(255,59,107,.18);
      position: absolute;
      left: 30%;
      top: 50%;
      transform: translate(-50%, -50%) scale(var(--yesScale, 1));
      transform-origin: center;
    }
    .yes:hover{ filter: brightness(1.06); }

    .no{
      background: rgba(255,255,255,.10);
      color: rgba(255,255,255,.92);
      border: 1px solid rgba(255,255,255,.18);
      box-shadow: 0 10px 24px rgba(0,0,0,.22);
      position: absolute;
      left: 74%;
      top: 50%;
      transform: translate(-50%, -50%);
    }
    .no:hover{ filter: brightness(1.08); }

    /* Success view */
    .success{
      display: none;
      margin-top: 14px;
      padding: 14px 12px 6px;
    }
    .success.show{ display: block; }
    .yay{
      font-size: clamp(34px, 5vw, 52px);
      font-weight: 900;
      margin: 0 0 8px;
      text-shadow: var(--glow);
    }
    .msg{
      margin: 0;
      color: rgba(255,255,255,.88);
      font-size: 15px;
    }

    /* Container for fireworks */
    #fx{
      position: fixed; inset: 0;
      pointer-events: none;
      z-index: 9999;
    }

    /* CSS-based firework particles */
    .fw-particle{
      position: fixed;
      width: 6px;
      height: 6px;
      border-radius: 50%;
      pointer-events: none;
      will-change: transform, opacity;
      z-index: 9999;
    }

    @keyframes fwBurst{
      0% { transform: translate3d(0, 0, 0) scale(0.5); opacity: 1; }
      100% { transform: translate3d(var(--fx), var(--fy), 0) scale(1.2); opacity: 0; }
    }

    /* small footer hint */
    .hint{
      margin: 12px 0 0;
      font-size: 12px;
      color: rgba(255,255,255,.55);
    }
    .hint code{
      background: rgba(255,255,255,.08);
      padding: 2px 6px;
      border-radius: 8px;
      border: 1px solid rgba(255,255,255,.10);
    }
  </style>
</head>
<body>
  <div class="aurora"></div>
  <div id="fx"></div>
  <div class="hearts-layer" id="hearts"></div>

  <!-- Audio element for yay sound -->
  <audio id="yaySound" preload="auto">
    <source src="yay.m4a" type="audio/mp4">
  </audio>

  <div class="wrap">
    <div class="card" id="card">
      <div class="content">
        <div class="subtitle" id="topline">He knows you're an indecisive queen</div>
        <h1 id="question">Will you be my valentine?</h1>

        <div class="hero">
          <div class="heroBox" aria-hidden="true">
            <!-- Swap this for an <img> if you want:
                 <img src="your-image.jpg" style="width:100%;height:100%;object-fit:cover" />
            -->
            <div class="emoji" id="emoji">ü•∫</div>
          </div>
          <div class="caption" id="caption">pls say yes</div>
        </div>

        <div class="btnRow">
          <div class="btns" id="btns">
            <button class="yes" id="yesBtn">Yes</button>
            <button class="no" id="noBtn">No</button>
          </div>
        </div>

        <div class="success" id="success">
          <p class="yay">YAY!!! üíñ</p>
          <p class="msg">Correct answer. We celebrate now.</p>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ---------- Floating background hearts ----------
    const heartsLayer = document.getElementById('hearts');
    const heartGlyphs = ['üíó','üíñ','üíò','üíù','üíï','üíì','üíû','‚ù§Ô∏è','ü©∑'];
    function spawnBgHeart() {
      const h = document.createElement('div');
      h.className = 'heart';
      h.textContent = heartGlyphs[(Math.random()*heartGlyphs.length)|0];

      const x = Math.random() * 100;         // vw
      const dur = 3 + Math.random() * 6;     // seconds (wider range)
      const size = 14 + Math.random() * 22;  // px

      // Wave amplitude and direction for smooth floating
      const waveAmp = (40 + Math.random() * 80).toFixed(0);
      const waveDir = Math.random() < 0.5 ? -1 : 1; // randomly go left or right
      const wave = (waveAmp * waveDir) + 'px';
      const dy = (window.innerHeight + 200).toFixed(0) + 'px';

      h.style.left = x + 'vw';
      h.style.fontSize = size + 'px';
      h.style.animationDuration = dur + 's';
      h.style.setProperty('--wave', wave);
      h.style.setProperty('--dy', dy);

      heartsLayer.appendChild(h);
      setTimeout(() => h.remove(), dur * 1000);
    }
    setInterval(spawnBgHeart, 220);

    // ---------- Indecisive "No" button logic ----------
    const btns = document.getElementById('btns');
    const yesBtn = document.getElementById('yesBtn');
    const noBtn  = document.getElementById('noBtn');
    const success = document.getElementById('success');
    const topline = document.getElementById('topline');
    const question = document.getElementById('question');
    const emoji = document.getElementById('emoji');
    const caption = document.getElementById('caption');

    let dodges = 0;
    const noPhrases = [
      "Are you sure?",
      "Really?",
      "Think again",
      "C'mon üòå",
      "Seriously?",
      "Don't do it",
      "Stop that",
      "Ok but... why",
      "lol no",
      "Still no?",
      "Wow okay",
      "This is silly",
      "Just say yes",
      "Please?",
      "Pretty please?",
      "Come onnn",
      "You're killing me",
      "Why tho",
      "Stopppp",
      "Last chance... maybe",
    ];

    function clamp(n, lo, hi){ return Math.max(lo, Math.min(hi, n)); }

    let noButtonEscaped = false;

    function placeNoRandom(mouseX, mouseY) {
      // Switch to fixed positioning on first dodge
      if (!noButtonEscaped) {
        noBtn.style.position = 'fixed';
        noBtn.style.zIndex = '1000';
        noButtonEscaped = true;
      }

      const minDistance = 250;

      // Use very conservative bounds that work even if viewport shrinks (e.g. DevTools opens)
      const rect = noBtn.getBoundingClientRect();
      const btnW = Math.ceil(rect.width);
      const btnH = Math.ceil(rect.height);

      // Assume minimum viewport of 1200x600 and keep button well within that
      const safeWidth = Math.min(window.innerWidth, 1200);
      const safeHeight = Math.min(window.innerHeight, 600);

      const marginX = 150;
      const marginY = 100;

      const maxX = safeWidth - btnW - marginX;
      const maxY = safeHeight - btnH - marginY;

      let x, y, attempts = 0;

      // Keep trying random positions until we find one far from the mouse
      do {
        x = marginX + Math.floor(Math.random() * (maxX - marginX));
        y = marginY + Math.floor(Math.random() * (maxY - marginY));

        const dist = Math.sqrt(
          Math.pow(x - mouseX, 2) +
          Math.pow(y - mouseY, 2)
        );

        if (dist >= minDistance) break;
        attempts++;
      } while (attempts < 20);

      console.log('Dodge:', {x, y, btnW, btnH, maxX, maxY, innerWidth: window.innerWidth, innerHeight: window.innerHeight});

      // Position fixed to viewport (no transform so x,y are exact top-left)
      noBtn.style.left = x + 'px';
      noBtn.style.top = y + 'px';
      noBtn.style.transform = 'none';
    }

    function growYes() {
      // Fast growth at first, then tapers off (square root curve)
      const scale = Math.min(5, 1 + Math.sqrt(dodges) * 0.35);
      document.documentElement.style.setProperty('--yesScale', String(scale));
      // move toward center, also tapering
      const leftPos = Math.min(50, 30 + Math.sqrt(dodges) * 2.5);
      yesBtn.style.left = leftPos + '%';
    }

    function updateText() {
      // Change phrase every 5 dodges
      const phraseIndex = Math.floor(dodges / 5) % noPhrases.length;
      const phrase = noPhrases[phraseIndex];
      noBtn.textContent = phrase;

      if (dodges >= 5) caption.textContent = "confused why no was even an option";
      if (dodges >= 15) emoji.textContent = "ü•π";
      if (dodges >= 25) emoji.textContent = "üòç";
      if (dodges >= 40) caption.textContent = "this is getting ridiculous";
      if (dodges >= 60) emoji.textContent = "üò≠";
      if (dodges >= 70) caption.textContent = "just give up already";
      if (dodges >= 85) emoji.textContent = "ü´†";
    }

    function dodgeNo(mouseX, mouseY) {
      dodges++;

      growYes();
      updateText();
      placeNoRandom(mouseX, mouseY);

      // Update text at milestones
      if (dodges >= 90) {
        yesBtn.textContent = "YES!!!";
        topline.textContent = "Ok, ok. We both know the answer.";
      }
    }

    // On desktop: hover triggers dodge. On mobile: touchstart triggers dodge.
    noBtn.addEventListener('mouseenter', (e) => dodgeNo(e.clientX, e.clientY));
    noBtn.addEventListener('touchstart', (e) => {
      e.preventDefault();
      const touch = e.touches[0];
      dodgeNo(touch.clientX, touch.clientY);
    }, {passive:false});

    // If they somehow click No, still dodge + deny politely
    noBtn.addEventListener('click', (e) => {
      e.preventDefault();
      dodgeNo(e.clientX, e.clientY);
    });

    // ---------- Sound effects ----------
    const yayAudio = document.getElementById('yaySound');
    yayAudio.volume = 0.7;

    function playYaySound() {
      yayAudio.currentTime = 0;
      yayAudio.play().catch(err => console.log('Audio play failed:', err));
    }

    // ---------- CSS-based Fireworks (GPU accelerated) ----------
    const fxContainer = document.getElementById('fx');
    const colors = ['#ff4fd8','#ff3b6b','#ffd1f0','#9fe7ff','#fff1a8'];

    function burst(x, y, count=90) {
      for (let i = 0; i < count; i++) {
        const particle = document.createElement('div');
        particle.className = 'fw-particle';

        // Random angle and distance
        const angle = Math.random() * Math.PI * 2;
        const distance = 50 + Math.random() * 200;
        const fx = Math.cos(angle) * distance;
        const fy = Math.sin(angle) * distance - Math.random() * 50;

        // Random color and duration
        const color = colors[Math.floor(Math.random() * colors.length)];
        const duration = 0.6 + Math.random() * 0.8;

        particle.style.left = x + 'px';
        particle.style.top = y + 'px';
        particle.style.backgroundColor = color;
        particle.style.boxShadow = `0 0 8px ${color}`;
        particle.style.setProperty('--fx', fx + 'px');
        particle.style.setProperty('--fy', fy + 'px');
        particle.style.animation = `fwBurst ${duration}s ease-out forwards`;

        fxContainer.appendChild(particle);

        // Remove after animation
        setTimeout(() => particle.remove(), duration * 1000 + 100);
      }
    }

    function celebrate() {
      success.classList.add('show');
      topline.textContent = "Indecisive queen defeated";
      question.textContent = "Will you be my valentine?";
      caption.textContent = "YAYYYYY!!!!";
      emoji.textContent = "ü•∞";

      // Play celebratory sound!
      playYaySound();

      // Hide the buttons nicely
      yesBtn.style.opacity = 0;
      noBtn.style.opacity = 0;
      yesBtn.style.pointerEvents = 'none';
      noBtn.style.pointerEvents = 'none';

      // CSS-based fireworks - optimized for smoothness
      const cx = window.innerWidth / 2;
      const cy = window.innerHeight / 2;
      const w = window.innerWidth;
      const h = window.innerHeight;

      // Initial center burst
      burst(cx, cy, 120);

      // Immediate bursts around center
      burst(cx - 200, cy - 150, 80);
      burst(cx + 200, cy - 150, 80);
      burst(cx - 200, cy + 100, 70);
      burst(cx + 200, cy + 100, 70);
      burst(cx, cy - 200, 60);

      // Cascading bursts across entire screen
      for (let i = 0; i < 15; i++) {
        setTimeout(() => {
          const x = 150 + Math.random() * (w - 300);
          const y = 100 + Math.random() * (h - 200);
          burst(x, y, 50 + Math.random() * 40);
        }, i * 120);
      }

      // Sustained finale bursts
      for (let i = 0; i < 10; i++) {
        setTimeout(() => {
          const x = 200 + Math.random() * (w - 400);
          const y = 150 + Math.random() * (h - 300);
          burst(x, y, 50);
        }, 1800 + i * 150);
      }

      // TONS of extra background hearts
      for (let i=0;i<100;i++) setTimeout(spawnBgHeart, i*25);

      // Enable mousedown-to-firework after celebration
      setTimeout(() => {
        document.addEventListener('mousedown', (e) => {
          burst(e.clientX, e.clientY, 80);
          // Spawn a few hearts too
          for (let i=0;i<3;i++) setTimeout(spawnBgHeart, i*50);
        });
      }, 500);
    }

    yesBtn.addEventListener('click', (e) => { e.preventDefault(); celebrate(); });

    // Make initial positions
    (function init(){
      btns.style.position = 'relative';

      yesBtn.style.position = 'absolute';
      yesBtn.style.left = '30%';
      yesBtn.style.top  = '50%';
      // Don't set transform inline - let CSS handle it with scale variable

      // Position No button the same way initially
      noBtn.style.position = 'absolute';
      noBtn.style.left = '70%';
      noBtn.style.top  = '50%';
      noBtn.style.transform = 'translate(-50%,-50%)';
    })();
  </script>
</body>
</html>
